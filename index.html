<!-- Everything stays the same above... -->
<script>
  const happinessQuestions = [
    "I feel generally satisfied with how my life is going.",
    "I often feel a sense of purpose in my day-to-day activities.",
    "I wake up looking forward to the day ahead.",
    "I feel emotionally fulfilled in my relationships.",
    "I rarely feel weighed down by anxiety or stress.",
    "I experience joy or contentment regularly.",
    "I’m proud of the person I’m becoming.",
    "I feel at peace with the choices I’ve made.",
    "I find beauty or meaning in small things.",
    "I feel I’m on the right path in life."
  ];

  const freedomQuestions = [
    "I feel free to make big changes in my life if I wanted to.",
    "I have the resources or support I need to pursue new directions.",
    "I rarely feel stuck in a situation I can’t change.",
    "I’ve chosen this life, rather than just fallen into it.",
    "I can express myself freely, without fear of judgement.",
    "I have a strong sense of agency over my future.",
    "I feel in control of my time and how I spend it.",
    "I can walk away from situations that don’t serve me.",
    "I’m not overly dependent on others’ expectations.",
    "I feel I could reinvent myself if I chose to."
  ];

  const feedbackText = {
    "The Resigned": "You may feel stuck in your current circumstances and deeply dissatisfied...",
    "The Restless": "You are free to make changes in your life — and you know it — but you still struggle to find contentment...",
    "The Settled": "You may have made commitments or taken on responsibilities that limit your freedom, but you’ve found peace in them...",
    "The Free and Fulfilled": "You enjoy both emotional well-being and the freedom to choose your path..."
  };

  const quadrantLabels = {
    "The Resigned": "The Resigned (Trapped and Unhappy)",
    "The Restless": "The Restless (Untrapped and Unhappy)",
    "The Settled": "The Settled (Trapped and Happy)",
    "The Free and Fulfilled": "The Free and Fulfilled (Untrapped and Happy)"
  };

  const addQuestions = (containerId, questions, prefix) => {
    const container = document.getElementById(containerId);
    questions.forEach((q, i) => {
      const div = document.createElement('div');
      div.className = 'question';
      div.innerHTML = `
        <label>${i + 1}. ${q}</label>
        <div class="options">
          ${[1, 2, 3, 4, 5].map(val => `
            <label>
              <input type="radio" name="${prefix}${i}" value="${val}" required> ${val}
            </label>
          `).join('')}
        </div>
      `;
      container.appendChild(div);
    });
  };

  addQuestions('happiness', happinessQuestions, 'h');
  addQuestions('freedom', freedomQuestions, 'f');

  let latestH = 0;
  let latestF = 0;
  let latestQuadrant = "";

  document.getElementById('quizForm').addEventListener('submit', function(e) {
    e.preventDefault();
    let hScore = 0, fScore = 0;

    for (let i = 0; i < 10; i++) {
      hScore += parseInt(document.querySelector(`input[name="h${i}"]:checked`).value);
      fScore += parseInt(document.querySelector(`input[name="f${i}"]:checked`).value);
    }

    let quadrant = '';
    if (hScore <= 30 && fScore <= 30) quadrant = 'The Resigned';
    else if (hScore <= 30 && fScore > 30) quadrant = 'The Restless';
    else if (hScore > 30 && fScore <= 30) quadrant = 'The Settled';
    else quadrant = 'The Free and Fulfilled';

    latestH = hScore;
    latestF = fScore;
    latestQuadrant = quadrant;

    const summary = `Your Scores — Happiness: ${hScore}, Freedom: ${fScore}\n\nQuadrant: ${quadrant}\n\n${feedbackText[quadrant]}`;
    document.getElementById('result').innerText = summary;
    document.getElementById('shareWhatsApp').style.display = 'block';

    const ctx = document.getElementById('quadrantChart').getContext('2d');
    if (window.myChart) window.myChart.destroy();

    window.myChart = new Chart(ctx, {
      type: 'scatter',
      data: {
        datasets: [{
          label: 'You',
          data: [{ x: fScore, y: hScore }],
          backgroundColor: 'red',
          pointRadius: 8
        }]
      },
      options: {
        plugins: { legend: { display: false }},
        scales: {
          x: {
            min: 0,
            max: 50,
            title: { display: true, text: 'Freedom' },
            ticks: { stepSize: 10 }
          },
          y: {
            min: 0,
            max: 50,
            title: { display: true, text: 'Happiness' },
            ticks: { stepSize: 10 }
          }
        }
      }
    });
  });

  function shareOnWhatsApp() {
    const label = quadrantLabels[latestQuadrant] || latestQuadrant;

    const message = encodeURIComponent(
      `I just took Debbi's "Trapped or Happy" quiz and here are my results.\n\nI am ${label}.\nHappiness score: ${latestH}\nFreedom score: ${latestF}\n\nTry the quiz yourself here: https://debbiediscovers.github.io/trapped-quiz/`
    );

    const url = `https://wa.me/?text=${message}`;
    window.open(url, '_blank');
  }
</script>
</body>
</html>
